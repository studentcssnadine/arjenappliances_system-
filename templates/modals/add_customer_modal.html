<!-- Add Customer Modal -->
<div class="modal-overlay" id="addCustomerModal">
    <div class="modal-container">
        <div class="modal-header">
            <h3><i class="fas fa-user-plus"></i> Add New Customer</h3>
            <button type="button" class="modal-close" onclick="closeAddCustomerModal()">
                <i class="fas fa-times"></i>
            </button>
        </div>
        
        <form id="addCustomerForm" method="POST" action="{% url 'add_customer' %}">
            {% csrf_token %}
            <div class="modal-body">
                <div class="form-row">
                    <div class="form-group">
                        <label for="customers_name">Customer Name <span class="required">*</span></label>
                        <input type="text" name="customers_name" id="customers_name" required>
                    </div>
                    <div class="form-group">
                        <label for="address">Address</label>
                        <input type="text" name="address" id="address">
                    </div>
                </div>
                
                <div class="form-row">
                    <div class="form-group">
                        <label for="phone">Phone Number</label>
                        <input type="tel" name="phone" id="phone">
                    </div>
                    <div class="form-group">
                        <label for="email">Email</label>
                        <input type="email" name="email" id="email">
                    </div>
                </div>
                
                <div class="form-row">
                    <div class="form-group">
                        <label for="item">Item <span class="required">*</span></label>
                        <input type="text" name="item" id="item" required>
                    </div>
                    <div class="form-group">
                        <label for="item_model">Item Model</label>
                        <input type="text" name="item_model" id="item_model">
                    </div>
                </div>
                
                <div class="form-row">
                    <div class="form-group">
                        <label for="original_price">Original Price <span class="required">*</span></label>
                        <input type="number" name="original_price" id="original_price" step="0.01" min="0" required>
                    </div>
                    <div class="form-group">
                        <label for="downpayment">Down Payment</label>
                        <input type="number" name="downpayment" id="downpayment" step="0.01" min="0">
                    </div>
                </div>
                
                <div class="form-row">
                    <div class="form-group">
                        <label for="term">Term (months) <span class="required">*</span></label>
                        <select name="term" id="term" required>
                            <option value="">Select term...</option>
                            <option value="6">6 months</option>
                            <option value="12">12 months</option>
                            <option value="18">18 months</option>
                            <option value="24">24 months</option>
                            <option value="36">36 months</option>
                        </select>
                    </div>
                    <div class="form-group">
                        <label for="rebates">Rebate Amount</label>
                        <input type="number" name="rebates" id="rebates" step="0.01" min="0">
                    </div>
                </div>
                
                <div class="form-row">
                    <div class="form-group">
                        <label for="good_as_cash">Good as Cash Price</label>
                        <input type="number" name="good_as_cash" id="good_as_cash" step="0.01" min="0">
                    </div>
                    <div class="form-group">
                        <label for="purchase_date">Purchase Date</label>
                        <input type="date" name="purchase_date" id="purchase_date">
                    </div>
                </div>
                
                <div class="form-group">
                    <label for="delivery_date">Delivery Date</label>
                    <input type="date" name="delivery_date" id="delivery_date">
                </div>
            </div>
            
            <div class="modal-footer">
                <button type="button" class="btn btn-secondary" onclick="closeAddCustomerModal()">
                    <i class="fas fa-times"></i> Cancel
                </button>
                <button type="submit" class="btn btn-primary">
                    <i class="fas fa-save"></i> Add Customer
                </button>
            </div>
        </form>
    </div>
</div>

<script>
function showAddCustomerModal() {
    document.getElementById('addCustomerModal').classList.add('show');
    document.body.style.overflow = 'hidden';
    
    // Set today's date as default
    const today = new Date().toISOString().split('T')[0];
    document.getElementById('purchase_date').value = today;
}

function closeAddCustomerModal() {
    document.getElementById('addCustomerModal').classList.remove('show');
    document.body.style.overflow = 'auto';
    document.getElementById('addCustomerForm').reset();
}

// Auto-calculate monthly due when values change
document.addEventListener('DOMContentLoaded', function() {
    const originalPrice = document.getElementById('original_price');
    const downpayment = document.getElementById('downpayment');
    const term = document.getElementById('term');
    
    function calculateMonthlyDue() {
        const price = parseFloat(originalPrice.value) || 0;
        const down = parseFloat(downpayment.value) || 0;
        const months = parseInt(term.value) || 1;
        
        if (price > 0 && months > 0) {
            const monthlyDue = (price - down) / months;
            // You can display this somewhere if needed
        }
    }
    
    originalPrice.addEventListener('input', calculateMonthlyDue);
    downpayment.addEventListener('input', calculateMonthlyDue);
    term.addEventListener('change', calculateMonthlyDue);
});

// Close modal when clicking outside
document.getElementById('addCustomerModal').addEventListener('click', function(e) {
    if (e.target === this) {
        closeAddCustomerModal();
    }
});
</script>
